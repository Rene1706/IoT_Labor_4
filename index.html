<!--HTML Seite, die das Video und saemtliche Zustandsdaten des Raspberry Pi anzeigt-->

<!DOCTYPE HTML>
<html>

<head>
	<title>IKT CAR MONITORING</title>
	<style>
		body {
			background: #555;
			text-align: left;
			margin-top: 1%;
			zoom: 100%;

		}

		p {
			color: white;
			max-width: 50%;
		}

		th {
			color: white;
		}

		#column {

			width: 50%;
			float: left;

			position: relative;
		}
	</style>

</head>


<body>
	<script src="https://cdn.jsdelivr.net/npm/smoothie"></script>
	<!--script type="text/javascript" src="smoothie.js"></script-->
	UltraSound Right:<br>
	<canvas class="canvas" id="range_rChart" width="200" height="100"></canvas><br>
	<!--Aufgabe 4-->
	<!--Für jeden Datensatz muss eine Zeichenfläche 'canvas' definiert werden-->
	UltraSound Right:<br>
	<canvas class="canvas" id="range_rChart1" width="200" height="100"></canvas><br>
	UltraSound Right:<br>
	<canvas class="canvas" id="range_rChart2" width="200" height="100"></canvas><br>
	UltraSound Right:<br>
	<canvas class="canvas" id="range_rChart3" width="200" height="100"></canvas><br>
	UltraSound Right:<br>
	<canvas class="canvas" id="range_rChart4" width="200" height="100"></canvas><br>


	<!--Einparken -->
	<!--Es müssen Knöpfe zum Starten und Stoppen des Parkvorgangs definiert werden-->

	<script type="text/javascript">
		// Aufgabe 4
		//
		// Damit die Daten dargestellt werden können muss ein Websocket geöffnet werden, der bei jeder neuen Nachricht die Daten aus dieser Nachricht rausholt und visualisiert.
		var dataSocket = new WebSocket("ws://localhost:8081/ws");

		dataSocket.onopen = function () {
			console.log("connected")
			websocket.send("connection established")
		};

		dataSocket.onmessage = function (evt) {
			// Aufgabe 4
			// Die empfangenen Daten müssen an die Charts weitergegeben werden.
			console.log(event.data)
			var data = JSON.parse(event.data);

			// Update the chart with the received sensor data
			range_r.append(new Date().getTime(), parseFloat(data.distance));
		};

		dataSocket.onclose = function (evt) {
			console.log("disconnected");
		};


		// Aufgabe 4
		//
		// Für jeden Datensatz muss ein eine SmoothieChart in einem vorher definierten canvas-Element erstellt werden.
		var range_r = new TimeSeries()
		var range_rChart = new SmoothieChart({
			minValue: 0, maxValue: 300,
			grid: {
				strokeStyle: "rgb(125, 0, 0)", fillStyle: "rgb(60, 0, 0)",
				lineWidth: 1, millisPerLine: 250, verticalSections: 6
			}
		});

		var range_r = new TimeSeries();
		range_rChart.addTimeSeries(range_r);
		range_rChart.streamTo(document.getElementById("range_rChart1"), 100);
		var range_rChart = new SmoothieChart({
			minValue: 0, maxValue: 300,
			grid: {
				strokeStyle: 'rgb(125, 0, 0)', fillStyle: 'rgb(60, 0, 0)',
				lineWidth: 1, millisPerLine: 250, verticalSections: 6
			}
		});

		var range_r = new TimeSeries();
		range_rChart.addTimeSeries(range_r);
		range_rChart.streamTo(document.getElementById("range_rChart2"), 100);

		var range_rChart = new SmoothieChart({
			minValue: 0, maxValue: 300,
			grid: {
				strokeStyle: 'rgb(125, 0, 0)', fillStyle: 'rgb(60, 0, 0)',
				lineWidth: 1, millisPerLine: 250, verticalSections: 6
			}
		});

		var range_r = new TimeSeries();
		range_rChart.addTimeSeries(range_r);
		range_rChart.streamTo(document.getElementById("range_rChart3"), 100);

		var range_rChart = new SmoothieChart({
			minValue: 0, maxValue: 300,
			grid: {
				strokeStyle: 'rgb(125, 0, 0)', fillStyle: 'rgb(60, 0, 0)',
				lineWidth: 1, millisPerLine: 250, verticalSections: 6
			}
		});

		var range_r = new TimeSeries();
		range_rChart.addTimeSeries(range_r);
		range_rChart.streamTo(document.getElementById("range_rChart4"), 100);


	</script>

</body>

</html>